apiVersion: apps/v1
kind: Deployment
metadata:
  name: payment-service
  namespace: microservices
spec:
  replicas: 1
  selector:
    matchLabels:
      app: payment-service
  template:
    metadata:
      labels:
        app: payment-service
    spec:
      nodeSelector:
        kubernetes.io/hostname: my-dev-cluster-worker2
      containers:
        - name: payment-service
          # ƒê·ªïi t√™n image theo t√†i kho·∫£n docker hub c·ªßa b·∫°n cho ƒë·ªìng b·ªô
          image: huynhnhub2204958/payment-service:latest 
          imagePullPolicy: Always # ∆Øu ti√™n l·∫•y ·∫£nh local n·∫øu c√≥, ƒë·ª° ph·∫£i push l√™n Hub

          ports:
            - containerPort: 3002

          env:
            - name: PORT
              value: "3002"
            
            # K·∫øt n·ªëi MongoDB (d√πng service 'mongo' nh∆∞ file auth c·ªßa b·∫°n)
            - name: MONGODB_URI
              value: "mongodb://mongo:27017/auth_db"

            - name: JWT_SECRET
              value: "phongkham"

            # URL g·ªçi sang Booking Service (Giao ti·∫øp n·ªôi b·ªô K8s)
            # C·∫•u tr√∫c: http://<t√™n-service-booking>.<namespace>:80/api/appointment
            - name: BOOKING_SERVICE_URL
              # value: "http://appointment-service.microservices:80/api/appointment"
              value: "http://kong-kong-proxy.kong.svc.cluster.local:80/appointment"
            

            # C·∫•u h√¨nh PayPal Sandbox (Copy t·ª´ .env c·ªßa b·∫°n v√†o ƒë√¢y)
            - name: PAYPAL_API_URL
              value: "https://api-m.sandbox.paypal.com"
            
            # üëá Thay Client ID th·∫≠t c·ªßa b·∫°n v√†o ƒë√¢y
            - name: PAYPAL_CLIENT_ID
              value: "ARaDkZj07UbeveqFejxHCy-kWvnBVbZqOYOOYzu6EzeKxvOxDeobWaeeVdoyKmiSk-2u34UwseNgcmtb"
            
            # üëá Thay Secret Key th·∫≠t c·ªßa b·∫°n v√†o ƒë√¢y
            - name: PAYPAL_CLIENT_SECRET
              value: "ENnujkGfYs3xBjzX_krGDrwhRjjJfKunmyeEVXRNOEd_ChcjG1na54Tqnn66fMl-xJ5Cm2axYarM7SwA"

